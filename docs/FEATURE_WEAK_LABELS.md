# 特征列表与"弱标签"解释

更新日期: 2025-01-27  
版本: v2.1.0

## 为什么称为“弱标签” (weak labels)

本文档列出的序列特征并不等价于表达量本身，它们刻画的是若干与翻译效率、转录后稳定性、起始效率等“可度量的生物物理机制”。这些机制与蛋白表达水平在群体意义上通常呈单调相关（方向性一致），因此可作为优化方向的“路牌”，但不构成逐样本的一一映射或绝对预测。

- 这些特征是机制层面的 proxy（代理），不是结果本身。
- 在同一宿主、相近构建背景下，提升这些特征的方向，通常提升表达的概率，但并非保证。
- 推荐将其与模型分数（如 Evo2 派生 bpb/ΔNLL）与实验数据共同使用，形成多目标加权优化。

---

## 第三方依赖说明

本系统使用的特征计算依赖以下第三方数据库、软件和模型：

### 数据库依赖
- **UniProt/SwissProt**: 用于获取蛋白质元数据（审查状态、亚细胞定位、生物体信息等）
- **AlphaFold DB**: 用于获取蛋白质结构预测数据（pLDDT 分数、二级结构等）
- **Pfam**: 用于蛋白质域注释和进化分析

### 软件依赖
- **ViennaRNA Package**: 用于 RNA 二级结构预测和自由能计算
- **MMseqs2**: 用于多序列比对（MSA）构建和进化分析
- **AlphaFold2**: 用于蛋白质结构预测（通过 AlphaFold DB API）

### 模型依赖
- **Evo2 (Evolutionary Scale Modeling)**: 用于序列语言模型特征提取
  - 提供困惑度 (perplexity)、对数似然 (log-likelihood) 等特征
  - 用于计算 bpb (bits per base) 和 Δbpb 特征

### 宿主特异性数据
- **密码子使用表**: 基于各宿主基因组的高表达基因统计
- **tRNA 权重表**: 基于宿主 tRNA 基因拷贝数和修饰状态
- **密码子对偏好表**: 基于宿主基因组的相邻密码子统计

---

## 1) 密码子使用指数 (Codon Usage Indices)

### 1.1 CAI (Codon Adaptation Index)
- 定义：以宿主高表达基因的同义家族内相对适应值为权重，几何平均。
- 记每个密码子的相对适应值为 \( w_c = \frac{f(c)}{\max_{c' \in \text{syn}(aa)} f(c')} \)，其中 \( f(c) \) 为宿主表中的使用频率。
- 对 CDS 中的非终止密码子集合 \( \{c_i\}_{i=1}^N \)，
  \[ \mathrm{CAI} = \exp\left( \frac{1}{N} \sum_{i=1}^N \ln w_{c_i} \right). \]
- 方向性：更高 CAI → 更多“宿主偏好”密码子 → 翻译延伸更顺畅（tRNA 供应充足、竞争少）→ 表达倾向更高。

### 1.2 tAI (tRNA Adaptation Index)
- 定义：以 tRNA 权重近似可用性，家族内归一后求几何平均。
- 设每个密码子的原始 tRNA 权重 \( t_c \)，家族内最大权重 \( t^{\max}_{aa} = \max_{c \in \text{syn}(aa)} t_c \)，相对适应值 \( w_c = \frac{t_c}{t^{\max}_{aa}} \)。
- 对 \( N \) 个非终止密码子：
  \[ \mathrm{tAI} = \exp\left( \frac{1}{N} \sum_{i=1}^N \ln w_{c_i} \right). \]
- 方向性：更高 tAI → 与宿主 tRNA 供给更匹配 → 延伸更快、更稳 → 表达倾向更高。

### 1.3 FOP (Frequency of Optimal Codons)
- 定义：序列中“最优密码子”（同义家族中使用频率最高者）所占比例。
  \[ \mathrm{FOP} = \frac{\#\{c_i \text{ 是其家族最优}\}}{N}. \]
- 方向性：更高 FOP → 更多最优/高效密码子 → 延伸负担更小 → 表达倾向更高。

生物学机制依据：同义密码子存在宿主偏好，源于 tRNA 丰度、反密码子修饰与翻译动力学等差异。使用偏好密码子降低空翻译位点等待时间与核糖体拥堵。

---

## 2) 密码子对特征 (Codon Pair Features)

### 2.1 CPB (Codon Pair Bias)
- 定义：对相邻密码子对的宿主偏好分数取平均（预先由宿主统计得到的 \(\mathrm{CPB}(A\!B)\) 表）。
  \[ \overline{\mathrm{CPB}} = \frac{1}{N-1} \sum_{i=1}^{N-1} \mathrm{CPB}(c_i\!c_{i+1}). \]
- 方向性：更高（正向）平均 CPB → 更接近宿主常用或有利的邻接组合 → 可能降低多核糖体碰撞与 mRNA 不利结构 → 表达倾向更高。

### 2.2 CPS (Codon Pair Score)
- 定义：观测-期望比的对数分数，独立性基线下：
  \[ \mathrm{CPS}(A\!B) = \ln \frac{F(A\!B)}{F(A)\,F(B)}, \quad \overline{\mathrm{CPS}} = \frac{1}{N-1} \sum_{i=1}^{N-1} \mathrm{CPS}(c_i\!c_{i+1}). \]
  其中 \(F(\cdot)\) 为频率或概率。
- 方向性：\(\overline{\mathrm{CPS}}\) 较大 → 使用超过独立期望的相邻组合更多 → 与宿主序列组织规律更一致 → 表达倾向更高。

机制依据：相邻密码子影响相邻二核苷酸 (dinucleotide) 频率、mRNA 二级结构局部形态及核糖体步进协调性（包括罕见解码-常用解码的节律）。

---

## 3) 二核苷酸与基序 (Dinucleotides & Motifs)

### 3.1 CpG 与 UpA 的观测/期望 (Obs/Exp)
- 定义：对 DNA 以 T 表示 U。设序列长为 \(L\)，二核苷酸总数 \(L-1\)。
- 计数：\( \#\mathrm{CG}, \#\mathrm{TA}, \#\mathrm{C}, \#\mathrm{G}, \#\mathrm{T}, \#\mathrm{A} \)。
- 期望（独立基线）：
  \[ E[\mathrm{CG}] = (L-1)\,p(\mathrm{C})p(\mathrm{G}), \quad E[\mathrm{TA}] = (L-1)\,p(\mathrm{T})p(\mathrm{A}). \]
- 观测/期望：
  \[ \mathrm{ObsExp}_{\mathrm{CG}} = \frac{\#\mathrm{CG}}{E[\mathrm{CG}]}, \quad \mathrm{ObsExp}_{\mathrm{TA}} = \frac{\#\mathrm{TA}}{E[\mathrm{TA}]}. \]
- 方向性：
  - 细菌/酵母中，较低 UpA (TA) 通常有利于 mRNA 稳定性与翻译；\(\mathrm{ObsExp}_{\mathrm{TA}}\) 越小越好。
  - CpG (CG) 过高在部分宿主（脊椎动物）可触发免疫识别或甲基化相关效应；在原核中常被低估用。

机制依据：UpA 富集与内切核酸酶切位点、非理想结构折叠与 mRNA 半衰期缩短相关；CpG 在特定宿主与修饰/识别机制相关。

### 3.2 罕见密码子连续段 (Rare Codon Runs)
- 定义：在同义家族内以分位数阈值（如 20%）划定“低适应值”，长度 \(\ge k\) 的连续段记为惩罚。
- 方向性：更短/更少的罕见连续段 → 减少核糖体长时间停顿 → 表达倾向更高。

### 3.3 同聚物 (Homopolymers)
- 定义：\(\ge 6\) 的单碱基重复片段长度总和。
- 方向性：更短/更少 → 降低读框滑移/测序装配错误与转录异常风险。

### 3.4 禁止基序/限制性位点 (Forbidden Motifs)
- 定义：命中次数越多惩罚越大（工程约束）。
- 方向性：更少禁用位点 → 构建更稳健、转录/翻译更少障碍。

---

## 4) 组成与局部结构 (Composition & Local Structure)

### 4.1 GC 含量与滑窗 GC
- 定义：全局 GC 以及滑窗 GC 落在目标区间的比例。
- 方向性：过低或过高 GC 都会加剧非理想结构或资源占用；在目标区间内窗口比例越大越好。

### 4.2 起始区结构能 (5' region \(\Delta G\))
- 定义：用 ViennaRNA Package 近似 5' 起始邻域窗口（如 +1..+50）的 \(\Delta G\)。
- 依赖：ViennaRNA Package (v2.4.18+)
- 方向性：\(\Delta G\) 越"高"（越不负）→ 结构越松散 → 起始核糖体结合/起始扫描更容易 → 表达倾向更高。

---

## 5) 结构特征 (Structure Features)

### 5.1 蛋白质结构预测特征
- **pLDDT 分数**: 预测的局部距离差异测试分数，反映结构预测置信度
  - 依赖：AlphaFold DB API
  - 统计：均值、最小值、最大值、标准差、四分位数
- **二级结构组成**: 螺旋、折叠、无规卷曲的比例
  - 依赖：AlphaFold2 结构预测
- **可及表面积 (SASA)**: 溶剂可及表面积统计
  - 依赖：AlphaFold2 结构预测
- **无序性比例**: 结构无序区域的比例
  - 依赖：AlphaFold2 结构预测
- **跨膜螺旋**: 跨膜螺旋的数量和存在性
  - 依赖：AlphaFold2 结构预测

### 5.2 信号肽和跨膜预测
- **信号肽存在性**: 基于结构预测的信号肽检测
- **跨膜区域**: 跨膜螺旋的数量和分布

---

## 6) 进化特征 (Evolutionary Features)

### 6.1 多序列比对 (MSA) 特征
- **MSA 深度**: 比对中包含的序列数量
  - 依赖：MMseqs2 进行序列搜索和聚类
- **有效深度**: 考虑序列权重的有效序列数
- **覆盖度**: 序列比对覆盖的氨基酸位置比例
- **保守性**: 各位置氨基酸保守性统计
  - 依赖：MMseqs2 + 自定义保守性计算
- **共进化分数**: 基于 MSA 的共进化分析
  - 依赖：MMseqs2 + 共进化算法

### 6.2 域注释特征
- **Pfam 域数量**: 识别的蛋白质域数量
  - 依赖：Pfam 数据库
- **域密度**: 域覆盖的序列比例

---

## 7) 序列多样性 (Diversity)
- 定义：与参考集合的最小全局相似度 (identity)；超过阈值可线性惩罚。
- 方向性：在不牺牲功能的前提下，较低同一性鼓励库多样性与专利/知识产权空间。

---

## 8) Evo2 模型派生的"弱标签"

### 8.1 bpb (bits per base) 与 Δbpb
- 依赖：Evo2 (Evolutionary Scale Modeling) 语言模型
- 从现有字段推导：
  - 若有困惑度 \(\mathrm{ppl}\)：\( \mathrm{bpb} = \log_2(\mathrm{ppl}) \)。
  - 若有平均对数似然（nats）\(\overline{\ell}\)：\( \mathrm{bpb} = -\overline{\ell}/\ln 2 \)。
- 组内中位数参考：\( \Delta\mathrm{bpb} = \mathrm{bpb} - \mathrm{median\_bpb}_{\text{group}} \)。
- ΔNLL（bits）：\( \Delta\mathrm{NLL} = \Delta\mathrm{bpb} \times L \)。
- 方向性：bpb 越低/Δbpb 越负 → 语言模型认为"更自然/更接近训练分布" → 与高表达/常见构型更一致的倾向。

机制依据：大规模序列语言模型对"常见的、可翻译的、被自然选择偏好的"构型赋予更高似然，因而 bpb/Δbpb 可作为"序列可译性"的弱标签。

---

## 9) 为什么这些特征能做"路牌"

- 翻译延伸动力学：CAI/tAI/FOP 捕捉 tRNA 供需与解码速率；罕见连续段捕捉长时间停滞风险；密码子对统计刻画邻接调节与节律。
- mRNA 稳定性与结构：UpA/CpG、GC% 与局部 \(\Delta G\) 捕捉降解途径、结构障碍与起始可及性。
- 宿主依赖性：所有“偏好”均以宿主统计/表为基准（E. coli / Human / Yeast 等），因此方向具有环境条件性。
- 统计单调性而非等价：上述机制边际地调节翻译/稳定性，因此“更好”的特征组合增加高表达的概率与上限，但单条序列的表达仍受转录调控、载体上下文、培养条件等影响。

---

## 10) 聚合与权重 (Rules Score)

实际工程中常以加权和聚合上述项：
\[ \mathrm{Score} = \sum_k w_k\,f_k(\text{sequence}), \]
其中 \(f_k\) 为归一化特征（如 GC 窗口占比、\(\Delta G\) 映射、命中计数的惩罚等），\(w_k\) 为经验或学习到的权重。

- 单调性：若各 \(f_k\) 的单调方向合理，则整体分数与表达“倾向”呈单调相关。
- 取舍：不同宿主与构建目标下，\(w_k\) 可调整以平衡稳定性与产量（如降低 UpA 与保持足够 CAI）。

---

## 11) 最佳实践与注意事项

- 宿主特异表：使用与目标表达宿主匹配的密码子使用表、tRNA 权重与 CPB 表。
- 序列校验：CAI/tAI/FOP/CPS 等需合法 CDS（不含终止密码子，长度为 3 的倍数）。
- 起始窗口：\(\Delta G\) 与滑窗 GC 的窗口参数需与载体起始环境匹配。
- 相互作用：高 CAI 但 5' 结构过稳仍可能起始受阻；CPB 改善也需兼顾 UpA/CpG 与构建限制位点。
- 外部条件：启动子/RBS/Kozak、拷贝数、培养条件会显著改变最终表达量；弱标签提供方向，不替代条件优化。

---

## 12) 速查（方向性）

- CAI / tAI / FOP：越高越好（延伸更顺畅）。
- CPB / CPS：越高越好（邻接组合更有利）。
- UpA Obs/Exp：越低越好（稳定性更好）。
- CpG Obs/Exp：视宿主而定（在许多场景适度或偏低更稳妥）。
- 罕见连续段长度总和：越低越好。
- 同聚物总长：越低越好。
- 滑窗 GC 合格比例：越高越好（落在目标区间）。
- 5' \(\Delta G\)：越高（越不负）越好（起始可及性）。
- bpb / Δbpb：越低/越负越好（更“自然”）。

---

文档维护: CodonVerifier Team  
最后更新: 2025-01-27
